
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>introduction to ETL for Oracle - Blog In Isolation</title>
  <meta name="author" content="Andy C">

  
  <meta name="description" content="There are a variety of methods to extract, transform and load (ETL) data
in and out of an Oracle database. This short article provides an
overview of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.nbrightside.com/blog/2006/02/20/introduction-to-etl-for-oracle/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Blog In Isolation" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-385771-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Blog In Isolation</a></h1>
  
    <h2>There is a radiant darkness upon us</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.nbrightside.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about/">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Introduction to ETL for Oracle</h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-02-20T21:56:23+00:00" pubdate data-updated="true">Feb 20<span>th</span>, 2006</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>There are a variety of methods to extract, transform and load (ETL) data
in and out of an Oracle database. This short article provides an
overview of some of the basic options that are supplied with Oracle.</p>

<h3>L is for Load</h3>

<p>Firstly, we need a table to load data into. This SQL script creates a
table called PERSON.</p>

<pre><code>create table person
(person_id number(12),
forename varchar2(200),
surname varchar2(200),
title varchar2(10),
email varchar2(100),
gender varchar2(1),
ni_number varchar(30),
address1 varchar2(100),
address2 varchar2(100),
town varchar2(100),
county varchar2(100),
postcode varchar2(10),
country varchar2(100),
phone varchar2(100),
mobile varchar2(100),
salary number(12),
date_of_birth date);
</code></pre>

<p>The following PL/SQL procedure may be used to populate this table with
an arbitrary amount of data.</p>

<pre><code>create or replace
procedure load_person(p_records in pls_integer)
is
v_person_id person.person_id%type;
begin
for i in 1 .. p_records
loop
v_person_id := to_char(i);
insert into person
(person_id,
forename,
surname,
title,
email,
gender,
ni_number,
address1,
address2,
town,
county,
postcode,
country,
phone,
mobile,
salary,
date_of_birth)
values
(v_person_id,   /* person_id */
'Norman',     /* forename */
'Brightside',    /* surname */
'Mr',    /* title */
'norman@brightside.com',  /* email */
'M',    /* gender */
'AA123456B',   /* ni_number */
'Leafy Cottage',    /* address1 */
'1 New Street',   /* address2 */
'Anytown',    /* town */
'Anycounty',    /* county */
'NN12 9ZZ',    /* postcode */
'UK',     /* country */
'0208444555',   /* phone */
'07789123321',   /* mobile */
20000,    /* salary */
'01-JAN-1970'   /* DOB */
);
end loop;
commit;
end;
</code></pre>

<p>Loading 1,000,000 records took 1 min 54 secs running Oracle 10g (10.2.1)
on my home PC.</p>

<p>One obvious deficiency in the PL/SQL is that all records (and the SQL
statement) are identical. In practice, this will not be the case.
Therefore, it may be beneficial to replace the literal SQL with bind
variables using using native, dynamic SQL.</p>

<pre><code>create or replace
procedure load_bind(p_records in pls_integer)
is
sql_stmt varchar2(2000);
v_person_id person.person_id%type;
v_forename person.forename%type := 'Norman';
v_surname person.surname%type := 'Brightside';
v_title person.title%type := 'Mr';
v_email person.email%type := 'norman@brightside.com';
v_gender person.gender%type := 'M';
v_ni_number person.ni_number%type := 'AA123456B';
v_address1 person.address1%type := 'Leafy Cottage';
v_address2 person.address2%type := '1 New Street';
v_town person.town%type := 'Anytown';
v_county person.county%type := 'Anycounty';
v_postcode person.postcode%type := 'NN12 9ZZ';
v_country person.country%type := 'UK';
v_phone person.phone%type := '0208444555';
v_mobile person.mobile%type := '07789123321';
v_salary person.salary%type := 20000;
v_date_of_birth person.date_of_birth%type := to_date('01-JAN-1970', 'DD-MON-YYYY');
begin
sql_stmt :=
'insert into person
(person_id,
forename,
surname,
title,
email,
gender,
ni_number,
address1,
address2,
town,
county,
postcode,
country,
phone,
mobile,
salary,
date_of_birth)
values (:v_person_id,
:v_forename,
:v_surname,
:v_title,
:v_email,
:v_gender,
:v_ni_number,
:v_address1,
:v_address2,
:v_town,
:v_county,
:v_postcode,
:v_country,
:v_phone,
:v_mobile,
:v_salary,
:v_date_of_birth)';
for i in 1 .. p_records
loop
v_person_id := to_char(i);
execute immediate sql_stmt using
v_person_id,
v_forename,
v_surname,
v_title,
v_email,
v_gender,
v_ni_number,
v_address1,
v_address2,
v_town,
v_county,
v_postcode,
v_country,
v_phone,
v_mobile,
v_salary,
v_date_of_birth;
end loop;
commit;
end;
/
show errors
</code></pre>

<p>The modified PL/SQL procedure took 2 mins 1 sec for 1 million records.
This doesn&#8217;t imply that bind variables are worse than literals. More
likely, that parsing overhead is relatively small for insert statements.</p>

<h3>E is for Extract</h3>

<p>People often ask why Oracle do not provide an equivalent SQL*Unloader
to dump tables to delimited files. Well, the standard SQL*Plus utility
may be used for such a purpose. Tom Kyte created some generic wrapper
<a href="http://asktom.oracle.com/~tkyte/flat/index.html">scripts</a> (for both
Unix and Windows) to dump an Oracle table to a delimited text file.</p>

<p>The &#8216;flat&#8217; utility was used to dump the contents of the PERSON table
into a comma separated value (CSV) file containing 1 million (identical)
records.</p>

<p>SQL*Loader was then used to immediately load the data back in to the
PERSON table again using this control file.</p>

<pre><code>LOAD DATA
TRUNCATE
INTO TABLE person
FIELDS TERMINATED BY "," OPTIONALLY ENCLOSED BY '"'
TRAILING NULLCOLS
(person_id,
forename,
surname,
title,
email,
gender,
ni_number,
address1,
address2,
town,
county,
postcode,
country,
phone,
mobile,
salary,
date_of_birth
)
</code></pre>

<p>The time taken was 1 min 25 secs for conventional mode and 28 seconds
when specifying DIRECT=TRUE for a direct path load.</p>

<p>Another interesting and often overlooked method for loading data is the
use of external tables. This allows the creation of a virtual read-only
table which is mapped directly to the host file using a CREATE TABLE
syntax (similar to that for SQL*Loader control file).</p>

<p>This SQL script creates an external table which can then be analysed
using standard SQL query tools without having to actually load a
database table.</p>

<pre><code>create table person_ext
(person_id number(12),
forename varchar2(200),
surname varchar2(200),
title varchar2(10),
email varchar2(100),
gender varchar2(1),
ni_number varchar(30),
address1 varchar2(100),
address2 varchar2(100),
town varchar2(100),
county varchar2(100),
postcode varchar2(10),
country varchar2(100),
phone varchar2(100),
mobile varchar2(100),
salary number(12),
date_of_birth date)
ORGANIZATION EXTERNAL
(TYPE ORACLE_LOADER
DEFAULT DIRECTORY data_dir
ACCESS PARAMETERS (FIELDS TERMINATED BY ',')
LOCATION ('person.dat')
);
</code></pre>

<p>It is then trivial to load data from the external table into a
conventional Oracle table as follows:</p>

<pre><code>SQL&gt; insert into person select * from person_ext;
</code></pre>

<p>\
 This method of data loading took 39 secs.</p>

<h3>T is for Transform</h3>

<p>And deliberately left until last. Extracting and loading data is
relatively easy. Often the time consuming and complicated task in ETL is
to identify, transform and potentially clean the data items from the
source system and map them to tables in the target database.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Andy C</span></span>

      








  


<time datetime="2006-02-20T21:56:23+00:00" pubdate data-updated="true">Feb 20<span>th</span>, 2006</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/uncategorised/'>uncategorised</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2006/02/19/poor-mans-satellite-navigation/" title="Previous Post: poor man's satellite navigation">&laquo; poor man's satellite navigation</a>
      
      
        <a class="basic-alignment right" href="/blog/2006/02/21/getting-things-don-spelled-correctly/" title="Next Post: Getting Things Don - spelled correctly">Getting Things Don - spelled correctly &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/09/14/the-awkward-second-post/">the awkward second post</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/14/hello-world/">Hello World</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/14/migration-plan/">migration plan</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/14/blog-migration/">blog migration checklist</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/14/autumn-migration/">Autumn migration</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Andy C -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'andycowl';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.nbrightside.com/blog/2006/02/20/introduction-to-etl-for-oracle/';
        var disqus_url = 'http://www.nbrightside.com/blog/2006/02/20/introduction-to-etl-for-oracle/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
