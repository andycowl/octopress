
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>in praise of CBO - Blog In Isolation</title>
  <meta name="author" content="Andy C">

  
  <meta name="description" content="Jonathan Lewis poses a very
interesting
question: Have you ever wondered how hard the optimizer has to work to produce a
plan ? Well actually &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.nbrightside.com/blog/2006/12/12/in-praise-of-cbo/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Blog In Isolation" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-385771-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Blog In Isolation</a></h1>
  
    <h2>There is a radiant darkness upon us</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.nbrightside.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about/">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">In Praise of CBO</h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-12-12T04:48:57+00:00" pubdate data-updated="true">Dec 12<span>th</span>, 2006</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Jonathan <a href="http://jonathanlewis.wordpress.com/">Lewis</a> poses a very
interesting
<a href="http://jonathanlewis.wordpress.com/2006/12/09/how-many-ways/">question</a>:</p>

<blockquote><p>Have you ever wondered how hard the optimizer has to work to produce a
plan ?</p></blockquote>

<p>Well actually Jonathan, curiously enough I have. Many times, in fact.</p>

<p>Siebel 7.7 (released in 2004) was the first version of Siebel to support
the Oracle cost based optimizer (CBO) and pleased a lot of demanding
Oracle DBA&#8217;s who looked contemptuously on the 10 year old rule based
optimizer (RBO) technology and had long petitioned Siebel to finally add
support for CBO to improve performance, support table partitioning,
parallel query, bitmap indexes and lots of other features they wanted to
use (i.e learn about).</p>

<p>Inevitably, this major architecture change brought improvements in
performance and was generally welcomed by new customers. However, the
use of CBO also introduced some new issues for existing, long-standing
Siebel customers who upgraded to 7.7 from previous releases.</p>

<p>For example, if you dug very deep with tkprof and ran comparative tests,
it was common to observe that parse times were increased with CBO. This
was because versions of Siebel prior to 7.7 used the rule based
optimizer which follows a fixed set of, 15, err, rules to determine the
query plan to be used. Consequently, parsing in RBO is deterministic and
relatively quick.</p>

<p>Academics proved that it was actually possible for a well-trained monkey
to learn and recite the 15 rules and accurately predict the query plan
that Oracle will select. Clever Siebel 2000 developers discovered they
could influence the chosen query plan by reciting magic incantations,
altering search specifications, sacrificing lambs, nullifying the use of
unhelpful indexes and even modifying the ordering of WHERE clauses in
the SQL statements.</p>

<p>However. as Siebel finally moved into the 1990&#8217;s and embraced CBO,
things suddenly became very different. The strategy for CBO is to simply
give the optimizer as much data as possible so the optimizer can make
the &#8216;best&#8217; decision regardless. Talented Siebel developers everywhere
quaked in their boots and now sacrificed their lambs, praying for a
contract renewal.</p>

<p>So whenever Siebel customers complained to me that parse times were too
high, I was often tempted to ask them:-</p>

<p>&#8216;How many pages of A4 did it take to print out this problematic query
with the high parse time ?&#8217;</p>

<p>&#8216;Err, 16.&#8217; &#8216;How many tables are joined ?&#8217;</p>

<p>&#8216;Well, err, 38.&#8217; &#8216;And how many outer joins are in this query ?&#8217;</p>

<p>&#8216;Well, err, 12.&#8217; &#8216;How many indexes are defined on those 38 tables ?&#8217;</p>

<p>&#8216;Well, err, 189 ?&#8217;</p>

<p>&#8216;So, if I gave you detailed statistics on those 38 tables together with
even more statistics on those 189 indexes together with frequency
histograms of all of the columns involved, how long would it take you to
parse that query and tell me the best query plan to return the data as
quickly as possible ?&#8217;</p>

<p>&#8216;Well, err, I&#8217;m not sure&#8217;</p>

<p>&#8216;And how long do you think it would it take you to write a computer
program to crunch all that data and return the best query plan ?&#8217;</p>

<p>&#8216;Well, err, I really don&#8217;t know&#8217;</p>

<p>&#8216;So do you still think that 3.4 seconds is really too long to parse this
statement for the first time and sub-second thereafter ?&#8217;.</p>

<p>&#8216;Well, err no, I guess not&#8217;.</p>

<p>Now I am lucky enough to work for Oracle, I have visibility to a wide
variety of complicated CBO related bugs including detailed analysis from
Technical Support and Engineering of 10053 trace files.</p>

<p>Consequently, I have nothing but complete respect for the software
engineers who develop, maintain, fix and seek to improve the Oracle cost
based optimizer.</p>

<p>[ I can thoroughly recommend Jonathan Lewis&#8217;
<a href="http://www.amazon.co.uk/Cost-Based-Oracle-Fundamentals-Experts/dp/1590596366/sr=8-1/qid=1165872049/ref=sr_1_1/203-2869917-8143900?ie=UTF8&amp;s=books">book</a>
as an excellent introduction with plenty of examples to illustrate how
the CBO works. ]</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Andy C</span></span>

      








  


<time datetime="2006-12-12T04:48:57+00:00" pubdate data-updated="true">Dec 12<span>th</span>, 2006</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/uncategorised/'>uncategorised</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2006/12/11/people-are-strange/" title="Previous Post: people are strange">&laquo; people are strange</a>
      
      
        <a class="basic-alignment right" href="/blog/2006/12/12/uk-tabloid-daily-express-files-for-bankruptcy/" title="Next Post: UK tabloid Daily Express files for bankruptcy">UK tabloid Daily Express files for bankruptcy &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/09/14/the-awkward-second-post/">the awkward second post</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/14/hello-world/">Hello World</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/14/migration-plan/">migration plan</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/14/blog-migration/">blog migration checklist</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/14/autumn-migration/">Autumn migration</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Andy C -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'andycowl';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.nbrightside.com/blog/2006/12/12/in-praise-of-cbo/';
        var disqus_url = 'http://www.nbrightside.com/blog/2006/12/12/in-praise-of-cbo/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
